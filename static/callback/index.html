<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Redirecionando...</title>
    <style>
        body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif; background-color: #1a1a1a; color: #ccc; text-align: center; padding-top: 4rem; }
        .spinner { border: 4px solid rgba(255, 255, 255, 0.2); border-top: 4px solid #0B428B; border-radius: 50%; width: 40px; height: 40px; animation: spin 1s linear infinite; margin: 2rem auto; }
        a { color: #0B428B; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
    </style>
</head>
<body>
    <h1>Gaming Memories</h1>
    <div class="spinner"></div>
    <p id="message">Redirecionando para o aplicativo...</p>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const params = new URLSearchParams(window.location.search);
            const authCode = params.get('code');

            if (!authCode) {
                document.getElementById('message').innerText = 'ERRO: Código de autorização não encontrado na URL.';
                return;
            }

            const userAgent = navigator.userAgent || navigator.vendor || window.opera;
            let deepLinkUrl;

            if (/android/i.test(userAgent) || /iPad|iPhone|iPod/.test(userAgent) && !window.MSStream) {
                deepLinkUrl = `capacitor://localhost/auth/callback?code=${authCode}`;
            } else {
                deepLinkUrl = `gmemories:///auth/callback?code=${authCode}`;
            }

            window.location.href = deepLinkUrl;
        });
    </script>
</body>
</html>